!function(){"use strict";function t(t){return t.split(/[/?#]/)}function e(t,e){var n=e.replace(/\?/g,"\\?").replace(/\*/g,"([^/?#]+?)").replace(/\.\./,".*"),r=new RegExp("^"+n+"$"),i=t.match(r);if(i)return i.slice(1)}function n(t,e){var n;return function(){clearTimeout(n),n=setTimeout(t,e)}}function r(t){h=n(s,1),L[x](z,h),L[x](C,h),T[x](O,f),t&&s(!0)}function i(){this.$=[],b(this),k.on("stop",this.s.bind(this)),k.on("emit",this.e.bind(this))}function o(t){return t.replace(/^\/|\/$/,"")}function a(t){return"string"==typeof t}function u(t){return(t||M.href).replace(w,"")}function c(t){return"#"===g[0]?(t||M.href||"").split(g)[1]||"":(M?u(t):t||"").replace(g,"")}function s(t){var e=0===P;if(!(S<=P)&&(P++,K.push(function(){var e=c();(t||e!==m)&&(k[E]("emit",e),m=e)}),e)){for(var n;n=K.shift();)n();P=0}}function f(t){if(!(1!==t.which||t.metaKey||t.ctrlKey||t.shiftKey||t.defaultPrevented)){for(var e=t.target;e&&"A"!==e.nodeName;)e=e.parentNode;!e||"A"!==e.nodeName||e[A]("download")||!e[A]("href")||e.target&&"_self"!==e.target||-1===e.href.indexOf(M.href.match(w)[0])||e.href!==M.href&&(e.href.split("#")[0]===M.href.split("#")[0]||"#"!==g[0]&&0!==u(e.href).indexOf(g)||"#"===g[0]&&e.href.split(g)[0]!==M.href.split(g)[0]||!l(c(e.href),e.title||T.title))||t.preventDefault()}}function l(t,e,n){return j?(t=g+o(t),e=e||T.title,n?j.replaceState(null,e,t):j.pushState(null,e,t),T.title=e,I=!1,s(),I):k[E]("emit",c(t))}function p(){d3.select(".backgroundContainer svg").attr("width",window.innerWidth).attr("height",window.innerHeight).select("g").attr("transform","translate("+window.innerWidth/2+","+(window.innerHeight-150)+")")}function d(t){J.init(),J.rotate.start(),U.init(t),U.on("gallery.progress",function(t,e){$(".info").html(Math.round(100*e)+"%")}),U.on("gallery.complete",function(t){$(".info").html("Done!"),J.rotate.stop(),U.display()}),D("/",function(){}),D("/*",function(e){void 0===_(t).find({code:e})&&D("/")}),D.start(!0)}var h,g,m,v,y,b=function(t){t=t||{};var e={},n=Array.prototype.slice;return Object.defineProperties(t,{on:{value:function(n,r){return"function"==typeof r&&(e[n]=e[n]||[]).push(r),t},enumerable:!1,writable:!1,configurable:!1},off:{value:function(n,r){if("*"!=n||r)if(r)for(var i,o=e[n],a=0;i=o&&o[a];++a)i==r&&o.splice(a--,1);else delete e[n];else e={};return t},enumerable:!1,writable:!1,configurable:!1},one:{value:function(e,n){function r(){t.off(e,r),n.apply(t,arguments)}return t.on(e,r)},enumerable:!1,writable:!1,configurable:!1},trigger:{value:function(r){var i,o,a,u=arguments,c=arguments.length-1,s=new Array(c);for(a=0;a<c;a++)s[a]=u[a+1];for(i=n.call(e[r]||[],0),a=0;o=i[a];++a)o.apply(t,s);return e["*"]&&"*"!=r&&t.trigger.apply(t,["*",r].concat(s)),t},enumerable:!1,writable:!1,configurable:!1}}),t},w=/^.+?\/\/+[^/]+/,x="addEventListener",A="hasAttribute",z="popstate",C="hashchange",E="trigger",S=3,L="undefined"!=typeof window&&window,T="undefined"!=typeof document&&document,j=L&&history,M=L&&(j.location||L.location),N=i.prototype,O=T&&T.ontouchstart?"touchstart":"click",k=b(),B=!1,I=!1,K=[],P=0;N.m=function(t,e,n){!a(t)||e&&!a(e)?e?this.r(t,e):this.r("@",t):l(t,e,n||!1)},N.s=function(){this.off("*"),this.$=[]},N.e=function(t){this.$.concat("@").some(function(e){var n=("@"===e?v:y)(o(t),o(e));if(void 0!==n)return this[E].apply(null,[e].concat(n)),I=!0},this)},N.r=function(t,e){"@"!==t&&(t="/"+o(t),this.$.push(t)),this.on(t,e)};var R=new i,D=R.m.bind(R);D.create=function(){var t=new i,e=t.m.bind(t);return e.stop=t.s.bind(t),e},D.base=function(t){g=t||"#",m=c()},D.exec=function(){s(!0)},D.parser=function(n,r){n||r||(v=t,y=e),n&&(v=n),r&&(y=r)},D.query=function(){var t={};return(M.href||m).replace(/[?&](.+?)=([^&]*)/g,function(e,n,r){t[n]=r}),t},D.stop=function(){B&&(L&&(L.removeEventListener(z,h),L.removeEventListener(C,h),T.removeEventListener(O,f)),k[E]("stop"),B=!1)},D.start=function(t){B||(L&&("interactive"===document.readyState||"complete"===document.readyState?r(t):document.onreadystatechange=function(){"interactive"===document.readyState&&setTimeout(function(){r(t)},1)}),B=!0)},D.base(),D.parser();var H,Q,W,q=d3.arc().innerRadius(50).outerRadius(2e3),J={init:function(t){t=t||40,(H=d3.selectAll(".backgroundContainer").append("svg").append("g").append("g").classed("rotate stop",!0)).selectAll("path").data(new Array(t)).enter().append("path").attr("d",function(e,n,r){var i=2*Math.PI/t;return q({startAngle:n*i,endAngle:n*i+i/2})}),p()},resize:p,rotate:Q={start:function(){H.classed("stop",!1)},stop:function(){H.classed("stop",!0)},toggle:function(){H.classed("stop",!H.classed("stop"))}}},F=new createjs.LoadQueue(!0),G=!1;!function(t){var e=t({});t.subscribe=function(){e.on.apply(e,arguments)},t.unsubscribe=function(){e.off.apply(e,arguments)},t.publish=function(){e.trigger.apply(e,arguments)}}(jQuery);var U={init:function(t){W=t;var e=_(W).sortBy("z").map(function(t){return"img/people/"+t.id+".png"}).value();F.setMaxConnections(10),F.loadManifest(e),F.on("progress",function(t){$.publish("gallery.progress",t.progress)}),F.on("complete",function(t){G=!0,$.publish("gallery.complete")})},display:function(){G&&(_(W).filter(function(t){return 0!==t.z}).orderBy("z").forEach(function(t,e,n){window.setTimeout(function(){var r=$("<img data-id='"+t.id+"' style='z-index: "+(W.length-t.z)+"; width: "+t.w/2+"px; height: auto; left:"+t.x/2+"px; bottom:"+t.y/2+"px;' class='animated bounceIn' src='img/people/"+t.id+".png' alt=''>").appendTo(".peopleContainer");e+1===n.length&&r.on("animationend",function(){$(".peopleContainer img").removeClass("bounceIn")})},30*e)}),_(W).filter(function(t){return t.path}).orderBy("z").reverse().forEach(function(t,e,n){d3.select(".shapesContainer").datum(t).append("path").attr("d",t.path).attr("data-name",t.name).attr("data-id",t.id)}),$(".shapesContainer").on("mouseenter","path",function(t){var e=$(t.target);$(".info").html(e.data("name")),e.one("mouseleave",function(t){$(".info").html("")})}))},on:function(t,e){$.subscribe(t,e)}};$(function(){$.getJSON("data/data.json").then(d)}),$(window).on("resize",function(){J.resize()})}();
