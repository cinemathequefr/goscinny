!function(){"use strict";function e(e){return e.split(/[/?#]/)}function t(e,t){var n=t.replace(/\?/g,"\\?").replace(/\*/g,"([^/?#]+?)").replace(/\.\./,".*"),o=new RegExp("^"+n+"$"),i=e.match(o);if(i)return i.slice(1)}function n(e,t){var n;return function(){clearTimeout(n),n=setTimeout(e,t)}}function o(e){g=n(u,1),E[C](S,g),E[C](T,g),L[C](j,c),e&&u(!0)}function i(){this.$=[],x(this),P.on("stop",this.s.bind(this)),P.on("emit",this.e.bind(this))}function a(e){return e.replace(/^\/|\/$/,"")}function r(e){return"string"==typeof e}function s(e){return(e||D.href).replace(M,"")}function l(e){return"#"===w[0]?(e||D.href||"").split(w)[1]||"":(D?s(e):e||"").replace(w,"")}function u(e){var t=0===B;if(!(z<=B)&&(B++,Y.push(function(){var t=l();(e||t!==v)&&(P[k]("emit",t),v=t)}),t)){for(var n;n=Y.shift();)n();B=0}}function c(e){if(!(1!==e.which||e.metaKey||e.ctrlKey||e.shiftKey||e.defaultPrevented)){for(var t=e.target;t&&"A"!==t.nodeName;)t=t.parentNode;!t||"A"!==t.nodeName||t[A]("download")||!t[A]("href")||t.target&&"_self"!==t.target||-1===t.href.indexOf(D.href.match(M)[0])||t.href!==D.href&&(t.href.split("#")[0]===D.href.split("#")[0]||"#"!==w[0]&&0!==s(t.href).indexOf(w)||"#"===w[0]&&t.href.split(w)[0]!==D.href.split(w)[0]||!d(l(t.href),t.title||L.title))||e.preventDefault()}}function d(e,t,n){return I?(e=w+a(e),t=t||L.title,n?I.replaceState(null,t,e):I.pushState(null,t,e),L.title=t,X=!1,u(),X):P[k]("emit",l(e))}function f(){var e=$("body").outerWidth(!0),t=$("body").outerHeight(!0);d3.select("svg.background").attr("width",e).attr("height",t).select("g").attr("transform","translate("+e/2+","+(t-150)+")")}function h(e){var t=$(e.target);$.publish("gallery.mouseenter",t),t.one("mouseleave",function(e){$.publish("gallery.mouseleave")})}function p(e){return new Promise(function(t,n){window.setTimeout(t,e)})}function m(){ga("send","pageview",document.location.href)}var g,w,v,b,y,x=function(e){e=e||{};var t={},n=Array.prototype.slice;return Object.defineProperties(e,{on:{value:function(n,o){return"function"==typeof o&&(t[n]=t[n]||[]).push(o),e},enumerable:!1,writable:!1,configurable:!1},off:{value:function(n,o){if("*"!=n||o)if(o)for(var i,a=t[n],r=0;i=a&&a[r];++r)i==o&&a.splice(r--,1);else delete t[n];else t={};return e},enumerable:!1,writable:!1,configurable:!1},one:{value:function(t,n){function o(){e.off(t,o),n.apply(e,arguments)}return e.on(t,o)},enumerable:!1,writable:!1,configurable:!1},trigger:{value:function(o){var i,a,r,s=arguments,l=arguments.length-1,u=new Array(l);for(r=0;r<l;r++)u[r]=s[r+1];for(i=n.call(t[o]||[],0),r=0;a=i[r];++r)a.apply(e,u);return t["*"]&&"*"!=o&&e.trigger.apply(e,["*",o].concat(u)),e},enumerable:!1,writable:!1,configurable:!1}}),e},M=/^.+?\/\/+[^/]+/,C="addEventListener",A="hasAttribute",S="popstate",T="hashchange",k="trigger",z=3,E="undefined"!=typeof window&&window,L="undefined"!=typeof document&&document,I=E&&history,D=E&&(I.location||E.location),O=i.prototype,j=L&&L.ontouchstart?"touchstart":"click",P=x(),H=!1,X=!1,Y=[],B=0;O.m=function(e,t,n){!r(e)||t&&!r(t)?t?this.r(e,t):this.r("@",e):d(e,t,n||!1)},O.s=function(){this.off("*"),this.$=[]},O.e=function(e){this.$.concat("@").some(function(t){var n=("@"===t?b:y)(a(e),a(t));if(void 0!==n)return this[k].apply(null,[t].concat(n)),X=!0},this)},O.r=function(e,t){"@"!==e&&(e="/"+a(e),this.$.push(e)),this.on(e,t)};var R=new i,N=R.m.bind(R);N.create=function(){var e=new i,t=e.m.bind(e);return t.stop=e.s.bind(e),t},N.base=function(e){w=e||"#",v=l()},N.exec=function(){u(!0)},N.parser=function(n,o){n||o||(b=e,y=t),n&&(b=n),o&&(y=o)},N.query=function(){var e={};return(D.href||v).replace(/[?&](.+?)=([^&]*)/g,function(t,n,o){e[n]=o}),e},N.stop=function(){H&&(E&&(E.removeEventListener(S,g),E.removeEventListener(T,g),L.removeEventListener(j,c)),P[k]("stop"),H=!1)},N.start=function(e){H||(E&&("interactive"===document.readyState||"complete"===document.readyState?o(e):document.onreadystatechange=function(){"interactive"===document.readyState&&setTimeout(function(){o(e)},1)}),H=!0)},N.base(),N.parser();var Q,q,K,W,F=d3.arc().innerRadius(5).outerRadius(2e3),Z={init:function(e){e=e||40,(Q=d3.selectAll(".wrapper").append("svg").classed("background",!0).append("g").append("g").classed("rotate stop",!0)).selectAll("path").data(new Array(e)).enter().append("path").attr("d",function(t,n,o){var i=2*Math.PI/e;return F({startAngle:n*i,endAngle:n*i+i/2})}),f()},resize:f,rotate:q=function(){var e;return{start:function(t){Q.classed("stop",!1),t&&(window.clearTimeout(e),e=window.setTimeout(q.stop,1e3*t))},stop:function(){Q.classed("stop",!0),window.clearTimeout(e)},toggle:function(){Q.classed("stop",!Q.classed("stop"))}}}()},G={init:function(e,t,n){K=$("<div id='balloon'></div>").appendTo(t).attr("class","animated fast").css({right:"0px",bottom:"70.5px",width:"157.5px",height:"133px",backgroundImage:"url("+n+")"}).hide()},show:function(e){window.clearTimeout(W),K.removeClass("bounceOut").html(e).show().addClass("bounceIn")},hide:function(){W=window.setTimeout(function(){K.removeClass("bounceIn").addClass("bounceOut")},500)}};!function(e){var t=e({});e.subscribe=function(){t.on.apply(t,arguments)},e.unsubscribe=function(){t.off.apply(t,arguments)},e.publish=function(){t.trigger.apply(t,arguments)}}(jQuery);var J,U={display:function(e){return new Promise(function(t,n){_(e).orderBy("order").reverse().forEach(function(e,t,n){d3.select(".shapescontainer").datum(e).append("path").attr("d",e.path).attr("data-name",e.name).attr("data-id",e.id).attr("data-code",e.code).attr("data-textid",e.textId).style("display","none")}),_(e).orderBy("order").forEach(function(e,n,o){var i=e.anim||"bounceIn";window.setTimeout(function(){$(e.img).attr("data-id",e.id).css({zIndex:e.z,width:e.w*scale+"px",height:"auto",left:e.x*scale+"px",bottom:e.y*scale+"px"}).addClass("animated").addClass(i).appendTo(".peoplecontainer").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){$("path[data-id='"+e.id+"']").show()}),n===o.length-1&&($(".shapescontainer").one("mouseenter","path",function(e){h(e),$.publish("gallery.firstMouseenter"),$(".shapescontainer").on("mouseenter","path",function(e){h(e)})}),$(e.img).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",t))},50*n)})})},on:function(e,t){$.subscribe(e,t)}},V=!1;!function(e){var t=e({});e.subscribe=function(){t.on.apply(t,arguments)},e.unsubscribe=function(){t.off.apply(t,arguments)},e.publish=function(){t.trigger.apply(t,arguments)}}(jQuery);var ee={init:function(e){V||((J=new createjs.LoadQueue(!0)).setMaxConnections(parseInt(e,10)||8),V=!0)},load:function(e,t,n){return new Promise(function(o,i){V||i("Le module de chargement n'a pas été initialisé."),t&&J.removeAll(),J.loadManifest(e),n&&J.on("progress",function(e){$.publish("promiseLoad.progress",e.progress)}),J.on("complete",function(){o(J.getItems())}),J.on("error",function(){i("Erreur de chargement.")})})},on:function(e,t){$.subscribe(e,t)}};window.scale=.5;var te={content:_.template(["<h1><%= title %></h1>","<div class='text'><%= text %></div>"].join(""))};$(function(){var e=this,t={gallery:null,texts:null},n=null;window.onkeydown=function(e){return!(32==e.keyCode)},$(".textinnercontainer").perfectScrollbar({suppressScrollX:!0,wheelSpeed:3}),ee.init(),Z.init(),Z.rotate.start(30),ee.load(["img/studio.png","img/rg.png","img/balloon.png","data/gallery.json"]).then(function(e){t.gallery=e[3].result,$(e[0].result).attr("id","studio").appendTo(".gallerycontainer"),$(e[1].result).attr("id","rg").attr("class","animated bounce infinite").css({left:470*scale+"px",bottom:-60*scale+"px",width:500*scale+"px",height:530*scale+"px"}).appendTo(".gallerycontainer"),G.init(t.gallery,document.querySelector(".gallerycontainer"),e[2].result.src);var n=ee.load(["data/texts.json"].concat(_(t.gallery).map(function(e){return{id:e.id,src:"img/people/"+e.id+".png"}}).value()),!0,!0);return ee.on("promiseLoad.progress",function(e,t){$(".info").html(Math.round(100*t)+"%")}),n}).then(function(o){return $(".info").fadeOut(500),$("#rg").removeClass("bounce"),o=_(o).map(function(e){return e.result}).value(),t.texts=o.shift(),t.gallery=_(o).sortBy("item.id").zipWith(t.gallery,function(e,t){return _(t).assign({img:e}).value()}).map(function(e){var n=_(t.texts).find({id:e.text});return n?_(e).assign({code:n.code,textId:n.id}).value():e}).value(),N("/",function(){m(),$(".wrapper").removeClass("show"),$("a.caret-down").removeClass("rubberBand"),$("svg.background").removeClass("uderzo")}),N("/*",function(e){m(),n=e,void 0===_(t.texts).find({code:e})?(n=null,N("/")):("albert-uderzo"===e?($("svg.background").addClass("uderzo"),Z.rotate.start(15)):$("svg.background").removeClass("uderzo"),$(".textscroller").html(te.content(_(t.texts).find({code:e}))),p(200).then(function(){$(".textinnercontainer").scrollTop(0).perfectScrollbar("update")}),$(".wrapper").addClass("show"),$("a.caret-down").hide(),window.setTimeout(function(){$("a.caret-down").show().addClass("rubberBand")},450))}),N.start(!0),$("#title").on("click",function(){N("/")}),$(document).on("keyup",function(e){27===e.which&&N("/")}),$(".shapescontainer").on("click","path",function(e){N($(e.target).data("code"))}),$(document).on("mousewheel",_.debounce(function(e){e.deltaY<0&&""!==window.location.hash&&N("/"),e.deltaY>0&&null!==n&&N(n)}.bind(e),10)),$(window).on("resize",Z.resize),U.display(t.gallery)}).then(function(){U.on("gallery.mouseenter",function(e,t){G.show($(t).data("name"))}),U.on("gallery.mouseleave",G.hide)}).catch(function(e){console.error(e)}),$("a").on("click",function(){$(".wrapper").hasClass("show")?$(".wrapper").removeClass("show"):$(".wrapper").addClass("show")})}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)}(function(e){function t(t){var r=t||window.event,s=l.call(arguments,1),u=0,d=0,f=0,h=0,p=0,m=0;if(t=e.event.fix(r),t.type="mousewheel","detail"in r&&(f=-1*r.detail),"wheelDelta"in r&&(f=r.wheelDelta),"wheelDeltaY"in r&&(f=r.wheelDeltaY),"wheelDeltaX"in r&&(d=-1*r.wheelDeltaX),"axis"in r&&r.axis===r.HORIZONTAL_AXIS&&(d=-1*f,f=0),u=0===f?d:f,"deltaY"in r&&(f=-1*r.deltaY,u=f),"deltaX"in r&&(d=r.deltaX,0===f&&(u=-1*d)),0!==f||0!==d){if(1===r.deltaMode){var g=e.data(this,"mousewheel-line-height");u*=g,f*=g,d*=g}else if(2===r.deltaMode){var w=e.data(this,"mousewheel-page-height");u*=w,f*=w,d*=w}if(h=Math.max(Math.abs(f),Math.abs(d)),(!a||a>h)&&(a=h,o(r,h)&&(a/=40)),o(r,h)&&(u/=40,d/=40,f/=40),u=Math[u>=1?"floor":"ceil"](u/a),d=Math[d>=1?"floor":"ceil"](d/a),f=Math[f>=1?"floor":"ceil"](f/a),c.settings.normalizeOffset&&this.getBoundingClientRect){var v=this.getBoundingClientRect();p=t.clientX-v.left,m=t.clientY-v.top}return t.deltaX=d,t.deltaY=f,t.deltaFactor=a,t.offsetX=p,t.offsetY=m,t.deltaMode=0,s.unshift(t,u,d,f),i&&clearTimeout(i),i=setTimeout(n,200),(e.event.dispatch||e.event.handle).apply(this,s)}}function n(){a=null}function o(e,t){return c.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120==0}var i,a,r=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],s="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],l=Array.prototype.slice;if(e.event.fixHooks)for(var u=r.length;u;)e.event.fixHooks[r[--u]]=e.event.mouseHooks;var c=e.event.special.mousewheel={version:"3.1.12",setup:function(){var n=this;if(this.addEventListener)for(var o=s.length;o;)n.addEventListener(s[--o],t,!1);else this.onmousewheel=t;e.data(this,"mousewheel-line-height",c.getLineHeight(this)),e.data(this,"mousewheel-page-height",c.getPageHeight(this))},teardown:function(){var n=this;if(this.removeEventListener)for(var o=s.length;o;)n.removeEventListener(s[--o],t,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height"),e.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var n=e(t),o=n["offsetParent"in e.fn?"offsetParent":"parent"]();return o.length||(o=e("body")),parseInt(o.css("fontSize"),10)||parseInt(n.css("fontSize"),10)||16},getPageHeight:function(t){return e(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})})}();
